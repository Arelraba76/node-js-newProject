<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="base.css">
    <link rel="stylesheet" href="dashboard.css">
</head>
<body>
    <div id="page-container">
        <main id="content-wrap">
            <h1>Admin Dashboard</h1>
            <section id="store-stats">
                <h2>Store Statistics</h2>
                <!-- Store statistics will go here -->
            </section>

            <section id="add-shoe">
                <h2>Add New Shoe</h2>
                <form id="add-shoe-form">
                    <label for="title">Title:</label>
                    <input type="text" id="title" name="title" required>
                    <br>
                    <label for="price">Price:</label>
                    <input type="number" id="price" name="price" required>
                    <br>
                    <label for="image">Image URL:</label>
                    <input type="text" id="image" name="image" required>
                    <br>
                    <label for="category">Category:</label>
                    <input type="text" id="category" name="category" required>
                    <br>
                    <label for="description">Description:</label>
                    <textarea id="description" name="description" required></textarea>
                    <br>
                    <label for="stock">Stock:</label>
                    <input type="number" id="stock" name="stock" required>
                    <br>
                    <button type="submit">Add Shoe</button>
                </form>
            </section>

            <section id="shoe-actions">
                <h2>Manage Shoes</h2>
                <table id="shoe-table">
                    <thead>
                        <tr>
                            <th>Title</th>
                            <th>Price</th>
                            <th>Category</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="shoe-table-body">
                        <!-- Shoe rows will load here -->
                    </tbody>
                </table>
            </section>
        </main>
    </div>
    
    <script>
        async function loadShoes() {
            try {
                const response = await fetch('/shoes');
                const result = await response.json();
                if (response.ok) {
                    const shoeTableBody = document.getElementById('shoe-table-body');
                    shoeTableBody.innerHTML = '';
                    result.shoes.forEach(shoe => {
                        shoeTableBody.innerHTML += `
                            <tr>
                                <td>${shoe.title}</td>
                                <td>${shoe.price}</td>
                                <td>${shoe.category}</td>
                                <td>
                                    <button onclick="editShoe('${shoe._id}')">Edit</button>
                                    <button onclick="deleteShoe('${shoe._id}')">Delete</button>
                                    <button onclick="viewShoe('${shoe._id}')">View</button>
                                </td>
                            </tr>
                        `;
                    });
                } else {
                    alert(result.message);
                }
            } catch (error) {
                alert('Error: ' + error.message);
            }
        }
    
        async function editShoe(id) {
            // Add code to open the edit form
        }
    
        async function deleteShoe(id) {
            if (confirm('Are you sure you want to delete this shoe?')) {
                try {
                    const response = await fetch(`/shoes/${id}`, { method: 'DELETE' });
                    const result = await response.json();
                    if (response.ok) {
                        alert(result.message);
                        loadShoes(); // Reload shoes after deletion
                    } else {
                        alert(result.message);
                    }
                } catch (error) {
                    alert('Error: ' + error.message);
                }
            }
        }
    
        async function viewShoe(id) {
            // Add code to view the shoe details in a modal or a section on the same page
        }
    
        document.getElementById('add-shoe-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            const formData = new FormData(this);
            try {
                const response = await fetch('/shoes', {
                    method: 'POST',
                    body: JSON.stringify(Object.fromEntries(formData)),
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                const result = await response.json();
                if (response.ok) {
                    alert(result.message);
                    loadShoes(); // Reload shoes after adding a new one
                } else {
                    alert(result.message);
                }
            } catch (error) {
                alert('Error: ' + error.message);
            }
        });
    
        // Load shoes when the page loads
        document.addEventListener('DOMContentLoaded', loadShoes);
        loadShoes();
    </script>
    
</body>
</html>
