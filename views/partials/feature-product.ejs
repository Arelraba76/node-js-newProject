<section class="featured-products">
    <h2>Featured Products</h2>
    <div class="products">
        <% 
        // Function to shuffle an array using the Fisher-Yates algorithm
        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        // Clone and shuffle the shoes array
        let shuffledShoes = shoes.slice(); // Create a copy of the shoes array
        shuffle(shuffledShoes); // Shuffle the copied array

        // Loop to display the first 4 shoes from the shuffled array with stock greater than 0
        let count = 0;
        for (let i = 0; i < shuffledShoes.length && count < 4; i++) { 
            if (shuffledShoes[i].stock > 0) {
                %>
                <div class="product" data-id="<%= shuffledShoes[i]._id %>">
                    <img src="<%= shuffledShoes[i].image %>" alt="<%= shuffledShoes[i].title %>">
                    <h3 class="title"><%= shuffledShoes[i].title %></h3>
                    <p class="category"><%= shuffledShoes[i].category %></p>
                    <p class="price">$<%= shuffledShoes[i].price %></p>
                </div>
                <% 
                count++;
            }
        } 
        %>
    </div>
</section>